<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Leaflet Mapa de Cartagena</title>
  <!-- Script de Leaflet -->
  <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
  <!-- Hoja de estilos de Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" />
  <!-- TU HOJA DE ESTILOS EXTERNA -->
  <link rel="stylesheet" href="cartagena-styles.css" />
  <style>
    #mapa {
      width: 90%;
      height: 600px;
    }
  </style>
  <!-- Tus capas GeoJSON para Cartagena -->
  <script type="text/javascript" src="cartagena_barrios.js"></script>
  <script type="text/javascript" src="http://localhost:8080/geoserver/cartagena/wms?service=WMS&version=1.1.0&request=GetMap&layers=cartagena%3AIglesias&bbox=-75.56318443289993%2C10.354620598094762%2C-75.45379952180554%2C10.470681931613127&width=723&height=768&srs=EPSG%3A4326&styles=&format=application/openlayers"></script>
  <script type="text/javascript" src="cartagena_zinfluencia.js"></script>
  <!--script type="text/javascript" src="cartagena_actividad.js"></script-->
  <script type="text/javascript" src="cartagena_inmueblesd.js"></script>
  <script type="text/javascript" src="cartagena_aturisticas.js"></script>
  <script type="text/javascript" src="cartagena_bibliotecas.js"></script>
  <script type="text/javascript" src="cartagena_roads.js"></script>
</head>

<body>
  <header>
    <h1 style="font-size: 32px; color:#0000FF; text-align: center">Mapa de Barrios de Cartagena</h1>
    <p style="font-size: 20px; color:#00FFFF; text-align: center">Capas desde GeoJSON</p>
    <p style="font-size: 20px; color:#00FFFF; text-align: center">DIANA SIERRA</p>
  </header>

  <div id="mapa"></div>

  <script>
    function getColor(d) {
      return d > 10 ? '#800026' :
             d > 5 ? '#BD0026' :
             d > 3 ? '#E31A1C' :
             d > 2 ? '#FC4E2A' :
             d > 1 ? '#FD8D3C' :
             d > 0.5 ? '#FEB24C' :
             d > 0.25 ? '#FED976' :
                        '#FFEDA0';
    }
    
    /*function actividadStyle(feature) {
      return {
        fillColor: '#FF69B4',
        weight: 2,
        opacity: 0,
        color: 'black',
        fillOpacity: 0.5
      };
    }*/
    function style(feature) {
      return {
        fillColor: getColor(feature.properties.ID),
        weight: 2,
        opacity: 1,
        color: 'black',
        fillOpacity: 0.8
      };
    }

    function roadStyle(feature) {
      return {
        color: '#BEBEBE',
        weight: 1,
        opacity: 0.8
      };
    }

    var osmLink = '<a href="http://openstreetmap.org">OpenStreetMap</a>';
    var osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
    var osmAttrib = '&copy; ' + osmLink + ' Contributors';
    var osmMap = L.tileLayer(osmUrl, { attribution: osmAttrib });

    var mimapa = L.map('mapa', {
      measureControl: true,
      maxZoom: 20,
      center: new L.LatLng(10.3910, -75.4794), // Cartagena centro
      zoom: 13
    });
    osmMap.addTo(mimapa);

    L.marker([10.4237, -75.5475]).addTo(mimapa)
      .bindPopup("<b>Ubicación</b><br>Plaza de la Aduana, Cartagena.")
      .openPopup();

    var capasbase = {
      "Mapa OpenStreetMap": osmMap
    };



    var capa_barrios = L.geoJson(cartagena_barrios, { style: style }).addTo(mimapa);

    var capa_zinfluencia = L.geoJson(cartagena_zinfluencia, {
      style: style,
      onEachFeature: function (feature, layer) {
        layer.bindPopup("<b>Zona de Influencia:</b> " + feature.properties.Zona_Inf);
      }
    }).addTo(mimapa);

    /*var capa_actividad = L.geoJson(cartagena_actividad, {
      style: style,
      onEachFeature: function (feature, layer) {
        layer.bindPopup("<b>Área Actividad:</b> " + feature.properties.Detalle_Us);
      }
    }).addTo(mimapa);*/
    
    var capa_aturisticas = L.geoJson(cartagena_aturisticas, {
    pointToLayer: function (feature, latlng) {
        return L.marker(latlng);
    },
    onEachFeature: function (feature, layer) {
        layer.bindPopup('<b>' + feature.properties.nombre + '</b>');
    }
    }).addTo(mimapa);

    var capa_inmueblesd = L.geoJson(capa_inmueblesd, {
    pointToLayer: function (feature, latlng) {
        return L.marker(latlng);
    },
    onEachFeature: function (feature, layer) {
        layer.bindPopup('<b>' + feature.properties.nombre + '</b>');
    }
    }).addTo(mimapa);
  
    var capa_iglesias = L.geoJson(cartagena_iglesias, {
    pointToLayer: function (feature, latlng) {
        return L.marker(latlng);
    },
    onEachFeature: function (feature, layer) {
        layer.bindPopup('<b>' + feature.properties.nombre + '</b>');
    }
    }).addTo(mimapa);

        var capa_bibliotecas = L.geoJson(cartagena_bibliotecas, {
    pointToLayer: function (feature, latlng) {
        return L.marker(latlng);
    },
    onEachFeature: function (feature, layer) {
        layer.bindPopup('<b>' + feature.properties.nombre + '</b>');
    }
    }).addTo(mimapa);

    var capa_roads = L.geoJson(cartagena_roads, { style: roadStyle }).addTo(mimapa);


    var capasadicionales = {
      "Barrios de Cartagena": capa_barrios,
      //"Área Actividad": capa_actividad,
      "Zona de Influencia": capa_zinfluencia,
      "Iglesias": capa_iglesias,
      "Inmuebles Distrito": capa_inmueblesd,
      "Areas turisticas": capa_aturisticas,
      "Bibliotecas": capa_bibliotecas,
      "Carreteras": capa_roads
    };

    L.control.layers(capasbase, capasadicionales).addTo(mimapa);
  </script>
</body>
</html>
